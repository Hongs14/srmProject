<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team01.webapp.notice.dao.INoticeRepository">
	
	<select id="count" resultType="int">
		SELECT COUNT(*) FROM NOTICE
	</select>
	
	<select id="list" parameterType="pager" resultType="notice">
		<![CDATA[
			SELECT 
			    RNUM AS "seq",
			    NTC_NO AS "ntcNo",
			    USER_ID AS "userId",
			    NTC_TTL AS "ntcTtl",
			    NTC_INQ_CNT AS "ntcInqCnt",
			    NTC_WRT_DATE AS "ntcWrtDate"
			FROM(
			    SELECT 
			        NTC_NO,
			        NTC_TTL,
			        NTC_INQ_CNT,
			        NTC_WRT_DATE,
			        NTC_PRY,
			        USER_ID,
			        ROWNUM as RNUM

			    FROM(
			        SELECT 
			            n.NTC_NO,
			            n.NTC_TTL,
			            n.NTC_INQ_CNT,
			            n.NTC_WRT_DATE,
			            n.NTC_PRY,
			            u.USER_ID
			        FROM NOTICE n, USERS u
			        WHERE n.user_no = u.user_no
			        ORDER BY n.ntc_pry
			    )
			    WHERE ROWNUM <=#{endRowNo}
			)
			WHERE rnum >=#{startRowNo}
		]]>
	</select>
	
	<insert id="write" parameterType="notice">
		<![CDATA[
		
			INSERT INTO NOTICE( NTC_NO, USER_NO, NTC_TTL, NTC_CN, NTC_INQ_CNT, NTC_WRT_DATE, NTC_PRY)
			VALUES( ntcno_seq.nextval, #{userNo}, #{ntcTtl}, #{ntcCn}, 0, sysdate, #{ntcPry} ) 
		]]>
		
	</insert>


</mapper>